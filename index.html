<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Batch Calculator</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <meta name="theme-color" content="#2c3e50" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="header-container"></div>

  <main class="calculator">
    <div class="input-section">
      <label>Total Batch Size (L):
        <input type="number" id="totalLitres" step="0.1">
      </label>

      <label>SH Percentage (%):
        <input type="number" id="shPercent" step="0.1">
      </label>

      <label>Surfactant Ratio:
        <input type="number" id="surfactantRatio" step="0.001">
      </label>

      <label>Scent Ratio:
        <input type="number" id="scentRatio" step="0.001">
      </label>

      <button onclick="calculateMix()">Calculate Mix</button>
    </div>

    <div class="results" id="results" style="display: none;">
      <h2>Mix Results</h2>
      <p><strong>Water:</strong> <span id="waterLitres"></span> L</p>
      <p><strong>SH:</strong> <span id="shLitres"></span> L</p>
      <p><strong>Surfactant:</strong> <span id="surfactantLitres"></span> L</p>
      <p><strong>Scent:</strong> <span id="scentLitres"></span> L</p>
    </div>

    <div class="dial-buttons">
      <button onclick="applyPreset('low')">Low</button>
      <button onclick="applyPreset('medium')">Medium</button>
      <button onclick="applyPreset('high')">High</button>
      <button onclick="loadPreset()">Load Preset</button>
    </div>
  </main>

  <script src="header.js"></script>
  <script>
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        const container = document.getElementById('header-container');
        container.outerHTML = data;
        if (typeof initHeader === 'function') initHeader();
      })
      .catch(error => console.error("Error loading header:", error));

    function calculateMix() {
      const total = parseFloat(document.getElementById('totalLitres').value);
      const shPercent = parseFloat(document.getElementById('shPercent').value) / 100;
      const surfRatio = parseFloat(document.getElementById('surfactantRatio').value);
      const scentRatio = parseFloat(document.getElementById('scentRatio').value);

      const shLitres = total * shPercent;
      const surfactantLitres = total * surfRatio;
      const scentLitres = total * scentRatio;
      const waterLitres = total - (shLitres + surfactantLitres + scentLitres);

      document.getElementById('waterLitres').textContent = waterLitres.toFixed(2);
      document.getElementById('shLitres').textContent = shLitres.toFixed(2);
      document.getElementById('surfactantLitres').textContent = surfactantLitres.toFixed(2);
      document.getElementById('scentLitres').textContent = scentLitres.toFixed(2);
      document.getElementById('results').style.display = 'block';
    }

    function applyPreset(level) {
      const presets = {
        low: { sh: 1.5, surf: 0.01, scent: 0.001 },
        medium: { sh: 3.0, surf: 0.01, scent: 0.001 },
        high: { sh: 5.0, surf: 0.01, scent: 0.002 }
      };
      const preset = presets[level];
      document.getElementById('shPercent').value = preset.sh;
      document.getElementById('surfactantRatio').value = preset.surf;
      document.getElementById('scentRatio').value = preset.scent;
    }

    function loadPreset() {
      const preset = JSON.parse(localStorage.getItem("presetMix"));
      if (!preset) return alert("No preset found.");
      document.getElementById('shPercent').value = preset.sh;
      document.getElementById('surfactantRatio').value = preset.surf;
      document.getElementById('scentRatio').value = preset.scent;
    }
  </script>
</body>
</html>
