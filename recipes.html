<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Recipes</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <meta name="theme-color" content="#0f172a" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Load shared header -->
  <div id="header-container"></div>

  <div class="recipes-container" id="recipesContainer">
    <div class="empty-recipes" id="emptyMessage">No recipes available. Add your first recipe!</div>
  </div>

  <script src="header.js"></script>
  <script>
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header-container').innerHTML = data;
      })
      .catch(error => console.error("Error loading header:", error));

    function toggleDarkMode() {
      const html = document.documentElement;
      html.setAttribute('data-theme', html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
      localStorage.setItem('theme', html.getAttribute('data-theme'));
    }

    let isLocked = false;
    function toggleLock() {
      isLocked = !isLocked;
      const lockBtn = document.getElementById("lockBtn");
      if (lockBtn) lockBtn.textContent = isLocked ? "ðŸ”’" : "ðŸ”“";
      alert(isLocked ? "Dial is now locked." : "Dial is now unlocked.");
    }

    function loadRecipes() {
      const recipes = JSON.parse(localStorage.getItem("recipes") || "[]");
      const container = document.getElementById("recipesContainer");
      const emptyMessage = document.getElementById("emptyMessage");
      container.innerHTML = "";

      if (recipes.length === 0) {
        container.appendChild(emptyMessage);
      } else {
        recipes.forEach(recipe => {
          const recipeCard = document.createElement("div");
          recipeCard.className = "recipe-card";

          const title = document.createElement("div");
          title.className = "recipe-title";
          title.textContent = recipe.name;

          const description = document.createElement("div");
          description.className = "recipe-description";
          description.textContent = recipe.description;

          const buttons = document.createElement("div");
          buttons.className = "recipe-buttons";

          const viewButton = document.createElement("button");
          viewButton.className = "recipe-btn";
          viewButton.textContent = "View";
          viewButton.onclick = () => viewRecipe(recipe.id);

          const deleteButton = document.createElement("button");
          deleteButton.className = "recipe-btn";
          deleteButton.textContent = "Delete";
          deleteButton.onclick = () => deleteRecipe(recipe.id);

          buttons.appendChild(viewButton);
          buttons.appendChild(deleteButton);

          recipeCard.appendChild(title);
          recipeCard.appendChild(description);
          recipeCard.appendChild(buttons);

          container.appendChild(recipeCard);
        });
      }
    }

    function viewRecipe(id) {
      const recipes = JSON.parse(localStorage.getItem("recipes") || "[]");
      const recipe = recipes.find(r => r.id === id);
      if (recipe) {
        alert(`Name: ${recipe.name}\nDescription: ${recipe.description}\nIngredients: ${recipe.ingredients.join(', ')}`);
      }
    }

    function deleteRecipe(id) {
      let recipes = JSON.parse(localStorage.getItem("recipes") || "[]");
      recipes = recipes.filter(r => r.id !== id);
      localStorage.setItem("recipes", JSON.stringify(recipes));
      loadRecipes();
    }

    window.onload = loadRecipes;
  </script>
</body>
</html>
